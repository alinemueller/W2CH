!function o(i,s,c){function u(t,e){if(!s[t]){if(!i[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(f)return f(t,!0);var r=new Error("Cannot find module '"+t+"'");throw r.code="MODULE_NOT_FOUND",r}var a=s[t]={exports:{}};i[t][0].call(a.exports,function(e){return u(i[t][1][e]||e)},a,a.exports,o,i,s,c)}return s[t].exports}for(var f="function"==typeof require&&require,e=0;e<c.length;e++)u(c[e]);return u}({1:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.tasks=void 0;n.tasks=[{_id:"01e0ba3c-0693-4017-9401-3ab6f017ad1e",title:"Mietvertrag der neuen Wohnung unterzeichnen",days:90,days_after_move:0,_owner:"3d46bfaa-05c7-4ef9-bf5f-4ad37fb493d2",state:"default",_updatedDate:"2018-11-30T12:45:22.056Z",_createdDate:"2018-11-30T12:45:22.056Z"},{_id:"5b8462d9-4321-436f-a6cf-39cc3502f79d",title:"Form- und fristgerecht alte Wohnung kündigen",days:90,days_after_move:0,_owner:"3d46bfaa-05c7-4ef9-bf5f-4ad37fb493d2",_updatedDate:"2018-11-30T12:45:22.055Z",_createdDate:"2018-11-30T12:45:22.055Z"},{_id:"a274c55a-9fef-4e37-a83f-32e541fd1e2b",title:"Nachmieter suchen",days:90,days_after_move:0,_owner:"3d46bfaa-05c7-4ef9-bf5f-4ad37fb493d2",_updatedDate:"2018-11-30T12:45:22.054Z",_createdDate:"2018-11-30T12:45:22.054Z"},{_id:"c02a0480-7918-4600-8b8e-246f075b5e9a",title:"Auszugstermin mit altem Vermieter besprechen/vereinbaren",days:90,days_after_move:0,_owner:"3d46bfaa-05c7-4ef9-bf5f-4ad37fb493d2",_updatedDate:"2018-11-30T12:45:22.053Z",_createdDate:"2018-11-30T12:45:22.053Z"},{_id:"c279ba1b-afe7-4e82-9d74-ea3858acdb10",title:"Einzugstermin mit neuem Vermieter besprechen/vereinbaren",days:90,days_after_move:0,_owner:"3d46bfaa-05c7-4ef9-bf5f-4ad37fb493d2",_updatedDate:"2018-11-30T12:45:22.052Z",_createdDate:"2018-11-30T12:45:22.052Z"},{_id:"c5cb79ec-77dc-41e7-b5d5-38e0486d7710",title:"Ggf. Sonderurlaub bei Arbeitgeber einreichen",days:90,days_after_move:0,_owner:"3d46bfaa-05c7-4ef9-bf5f-4ad37fb493d2",_updatedDate:"2018-11-30T12:45:22.051Z",_createdDate:"2018-11-30T12:45:22.051Z"},{_id:"bdbdf93b-a290-45df-8652-3e4a31742a17",title:"Entscheiden, ob man für die Endreinigung der Wohnung ein Reinigungsinstitut beauftragt oder die Wohnung selbst putzt",days:90,days_after_move:0,_owner:"3d46bfaa-05c7-4ef9-bf5f-4ad37fb493d2",_updatedDate:"2018-11-30T12:45:22.050Z",_createdDate:"2018-11-30T12:45:22.050Z"},{_id:"3e889799-a541-48d9-a918-aa07770ddc16",title:"Entscheiden, ob man für den Umzug ein Umzugsunternehmen beauftragt oder den Umzug selbst durchführt",days:90,days_after_move:0,_owner:"3d46bfaa-05c7-4ef9-bf5f-4ad37fb493d2",_updatedDate:"2018-11-30T12:45:22.049Z",_createdDate:"2018-11-30T12:45:22.049Z"},{_id:"b545f00a-ccd7-447a-aa50-26137d4300bf",title:"Ggf. weitere Umzugshelfer organisieren",days:90,days_after_move:0,_owner:"3d46bfaa-05c7-4ef9-bf5f-4ad37fb493d2",_updatedDate:"2018-11-30T12:45:22.048Z",_createdDate:"2018-11-30T12:45:22.048Z"},{_id:"69ffae68-5ee5-4d78-ac71-b7469e765df1",title:"Offerten bei Umzugsunternehmen und/oder Reinigungsinstitut einholen",days:90,days_after_move:0,_owner:"3d46bfaa-05c7-4ef9-bf5f-4ad37fb493d2",_updatedDate:"2018-11-30T12:45:22.047Z",_createdDate:"2018-11-30T12:45:22.047Z"},{_id:"82d51fde-f1ce-48fe-af71-0a45234028b3",title:"Neue Wohnung ausmessen, bzw. Grundrissplan für die neue Wohnung anfordern",days:90,days_after_move:0,_owner:"3d46bfaa-05c7-4ef9-bf5f-4ad37fb493d2",_updatedDate:"2018-11-30T12:45:22.046Z",_createdDate:"2018-11-30T12:45:22.046Z"},{_id:"841f56b1-7d4a-4255-8822-fb01d95b2e4e",title:"Einrichtung der neuen Wohnung planen",days:90,days_after_move:0,_owner:"3d46bfaa-05c7-4ef9-bf5f-4ad37fb493d2",_updatedDate:"2018-11-30T12:45:22.045Z",_createdDate:"2018-11-30T12:45:22.045Z"},{_id:"05287b73-f471-43d4-bf1c-2c209739b3b2",title:"Ggf. Neuanschaffungen an neue Adresse bestellen",days:90,days_after_move:0,_owner:"3d46bfaa-05c7-4ef9-bf5f-4ad37fb493d2",_updatedDate:"2018-11-30T12:45:22.044Z",_createdDate:"2018-11-30T12:45:22.044Z"},{_id:"41966bff-d377-40af-b353-fff0bc0a95f7",title:"Mitgliedschaften und Abos kündigen, bzw. über Umzug informieren (z.b. Vereine, Zeitschriften, Kundenkarten)",days:90,days_after_move:0,_owner:"3d46bfaa-05c7-4ef9-bf5f-4ad37fb493d2",_updatedDate:"2018-11-30T12:45:22.043Z",_createdDate:"2018-11-30T12:45:22.043Z"}]},{}],2:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}Object.defineProperty(n,"__esModule",{value:!0}),n.add=function(e,t,n,r){var a=s=new n,o=c=new t,i=new r;return o.init(),u[e]={model:o,view:a,controller:i}},n.get=function(e){return u[e]},n.setNode=y,n.getNode=b,n.merge=p,n.Controller=n.View=n.Model=void 0;var s,c,u=[];var i=function(){function e(){r(this,e),this.tree={},this.callbacks={setPre:[],setPost:[],change:[]}}return o(e,[{key:"init",value:function(){for(var e in this.callbacks)this.callbacks.hasOwnProperty(e)&&this.runCallbacks(e)}},{key:"setPre",value:function(e){for(var t=this.callbacks.setPre,n=t.length;n--;)e=t[n].call(this,e);return e}},{key:"setPost",value:function(e){this.runCallbacks("setPost")}},{key:"change",value:function(){this.runCallbacks("change")}},{key:"set",value:function(e,t){var n,r,a,o;if(l(e)){var i=this.setPre(p({},e));p(this.tree,i,function(e){return n=e})}else{var s=e;t=this.setPre((r={},a=s,o=t,a in r?Object.defineProperty(r,a,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[a]=o,r))[s],n=y(this.tree,s,t)}return n&&this.change(),this.setPost(),this}},{key:"get",value:function(e){return b(this.tree,e)}},{key:"on",value:function(e,t){var n=this.callbacks[e];return n&&n.unshift(t),this}},{key:"runCallbacks",value:function(e){for(var t=this.callbacks[e],n=t.length;n--;)t[n].call(this,this.tree)}},{key:"toJSON",value:function(){return this.tree}}]),e}();n.Model=i;var f=function(){function e(){r(this,e)}return o(e,[{key:"get",value:function(e){return this.el.querySelector(e)}},{key:"getAll",value:function(e){return this.el.querySelectorAll(e)}}]),e}();n.View=f;var d=function(){function e(){if(r(this,e),this.model=c,!s.el)throw new Error("View.el required!");this.view=s,s=c=null}return o(e,[{key:"bind",value:function(e){for(var t in e)if(e.hasOwnProperty(t))for(var n=this.view.el.querySelectorAll(t),r=n.length;r--;)e[t].call(this,n[r],this.model,this.view,this);return this}}]),e}();function l(e){return!(e!==Object(e)||e.nodeType||Array.isArray(e)||"function"==typeof e||e instanceof RegExp)}function y(e,t,o){var i=!1;return b(e,t,function(e,t,n){if(void 0===n){var r=e[t];o!==r&&(e[t]=o,i=!0)}else void 0===e[t]&&(e[t]=(a=n,Number(parseFloat(a))==a?[]:{}));var a}),i}function b(e,t,n){for(var r=t.split("."),a=e,o=0,i=r.length;o<i;o++){var s=r[o];if(n&&n(a,s,r[o+1]),void 0===a)break;a=a[s]}return a}function p(){var u,f=0,d=!0,e=function e(t,n){var r,a,o=n.length;t&&(a=l(n[0])?n[0]:{});for(var i=0;i<o;i++){if(r=n[i],!t&&null!=r){if(!a&&l(r)||r.nodeName){a=r;continue}if("boolean"==typeof r){d=r;continue}if("function"==typeof r){u=r;continue}if(!a)continue}for(var s in r)if(r.hasOwnProperty(s)){var c=r[s];d&&l(c)?a[s]=e(t+1,[a[s],c]):c!==a[s]&&(f++,a[s]=c)}}return a||{}}.apply(this,[0,arguments]);return u&&u(!!f),e}n.Controller=d},{}],3:[function(e,t,n){"use strict";var r=o(e("./modules/boot/boot")),a=o(e("./modules/todoitems/todoitems"));function o(e){return e&&e.__esModule?e:{default:e}}(new r.default).then(function(){new a.default})},{"./modules/boot/boot":4,"./modules/todoitems/todoitems":7}],4:[function(e,t,n){"use strict";function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=function(){function e(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ready()}var t,n,r;return t=e,(n=[{key:"ready",value:function(){return new Promise(function(e,t){document.addEventListener("DOMContentLoaded",function(){/\w/.test(location.href)?e():t("Error")})})}}])&&a(t.prototype,n),r&&a(t,r),e}();n.default=r},{}],5:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}}(e("../../lib/app"));function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var a=function(e){function t(){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=s(this,c(t).call(this)),window.onmessage=function(e){a.registerOnMessageReceivedHandler(e)},a.model.on("change",function(e){console.log("model changed, view ".concat(a.view,", model toJSON: ").concat(JSON.stringify(a.model.toJSON()))),a.view.renderToDoItems(a.model.get("tasks")),a.view.setTitle(a.model.get("days")),a.bind({"span.close":function(e,t,n,r){e.onclick=function(e){return a.removeToDoItem(e)}}}),a.bind({li:function(e,t,n,r){e.onclick=function(e){return a.changeToDoItemStatus(e)}}})}),a.bind({"#addBtn":function(e,t,n,r){e.onclick=function(e){return a.addToDoItem(e)}}}),a.bind({"#todo":function(e,t,n,r){e.onkeypress=function(e){13==(e.keyCode?e.keyCode:e.which)&&a.addToDoItem(e)}}}),a}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(t,o.Controller),n=t,(r=[{key:"changeToDoItemStatus",value:function(e){if("SPAN"!==e.srcElement.tagName){var t,n,r=this.getClicked(e,t,n);t=r.li,(n=r.input).checked?(t.classList.add("checked"),t.dataset.state="completed"):(t.classList.remove("checked"),t.dataset.state="default");var a=this.getModelState(e);this.model.set({tasks:a.tasks}),this.sendMessageToWix({tasks:this.model.get("tasks"),save:"Y"})}}},{key:"getClicked",value:function(e,t,n){return"LABEL"===e.target.tagName&&(t=e.srcElement.parentElement,n=e.srcElement.children[0]),"SPAN"!==e.target.tagName&&"INPUT"!==e.target.tagName||(t=e.srcElement.parentElement.parentElement,n=e.srcElement),"LI"===e.target.tagName&&(n=(t=e.srcElement).children[0].children[0]),{li:t,input:n}}},{key:"removeToDoItem",value:function(e){e.preventDefault();var t=e.currentTarget.parentElement;t.style.display="none",t.dataset.state="deleted";var n=this.getModelState(e);this.model.set({tasks:n.tasks}),this.sendMessageToWix({tasks:this.model.get("tasks"),save:"Y"})}},{key:"addToDoItem",value:function(e){var t=this.view.get("#todo").value;if(t){var n=this.createGuid(),r={tasks:this.model.get("tasks")},a=this.model.get("days");0<r.tasks.length?r.tasks.unshift({_id:n,title:t,state:"custom",days:a.days,days_after_move:a.days_after_move}):r.tasks=[{_id:n,title:t,state:"custom",days:a.days,days_after_move:a.days_after_move}],console.log("item added, model state:",this.model.get("tasks")),this.model.set({tasks:r.tasks}),this.view.get("#todo").value="",this.sendMessageToWix({tasks:this.model.get("tasks"),save:"Y"})}}},{key:"sendMessageToWix",value:function(e){console.log("APP_ENV: sending to wix:",e),window.parent.postMessage(e,"*")}},{key:"prepareGetDataFromWix",value:function(){return{get:"Y"}}},{key:"fromReadyOrSave",value:function(e){return e.data.hasOwnProperty("ready")||e.data.hasOwnProperty("save")}},{key:"fromReadyOrGet",value:function(e){return e.data.hasOwnProperty("tasks")}},{key:"registerOnMessageReceivedHandler",value:function(e){console.log("APP_ENV: data received from wix in registerOnMessageReceivedHandler: ",e),e.data&&(this.fromReadyOrSave(e)&&this.sendMessageToWix(this.prepareGetDataFromWix()),this.fromReadyOrGet(e)&&this.model.set({tasks:e.data.tasks,days:e.data.days}))}},{key:"createGuid",value:function(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(e){return(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)})}},{key:"getModelState",value:function(e){var r=e.path.filter(function(e){return"LI"===e.tagName})[0].dataset;console.log(r);var t={tasks:this.model.get("tasks")};return t.tasks.map(function(e,t,n){return e._id===r.id&&(e.state=r.state),e}),t}}])&&i(n.prototype,r),a&&i(n,a),t}();n.default=a},{"../../lib/app":2}],6:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=a(e("../../lib/app"));a(e("../../json/data"));function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var u=function(e){function n(){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(t=i(this,s(n).call(this))).on("change",function(e){}),t.sanitize=function(e){for(var t in e)e.hasOwnProperty(t)&&"string"==typeof e[t]&&(e[t]=e[t].replace(/[^\w\s'!.,;]/g,""));return e},t.on("setPre",function(e){return t.sanitize(e)}),t.set({tasks:{}}),t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(n,r.Model),n}();n.default=u},{"../../json/data":1,"../../lib/app":2}],7:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}}(e("../../lib/app")),a=s(e("./model")),o=s(e("./view")),i=s(e("./controller"));function s(e){return e&&e.__esModule?e:{default:e}}n.default=function e(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),r.add("ToDoItems",a.default,o.default,i.default)}},{"../../lib/app":2,"./controller":5,"./model":6,"./view":8}],8:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}}(e("../../lib/app"));function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var a=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=s(this,c(t).call(this))).el=document.getElementById("todosection"),e.title=document.querySelector(".h2-title"),e}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(t,o.View),n=t,(r=[{key:"setTitle",value:function(e){var t;console.log("In set title, days: ".concat(e," type of days.days ").concat(e.days)),90===e.days&&0===e.days_after_move&&(t="3 Monate vor dem Umzug"),30===e.days&&0===e.days_after_move&&(t="1 Monat vor dem Umzug"),14===e.days&&0===e.days_after_move&&(t="2 Wochen vor dem Umzug"),1===e.days&&0===e.days_after_move&&(t="1 Tag vor dem Umzug"),0===e.days&&0===e.days_after_move&&(t="Am Umzugstag"),0===e.days&&14===e.days_after_move&&(t="Bis 14 Tage nach dem Umzug"),0===e.days&&90===e.days_after_move&&(t="Bis 3 Monate nach dem Umzug"),0===e.days&&300==e.days_after_move&&(t="Bis 12 Monate nach dem Umzug"),document.querySelector(".h2-title").innerHTML=t}},{key:"renderToDoItems",value:function(e){if(e){e.days&&(this.get(".h2-title").innerHTML="".concat(e.days," days before move"));var t=Array.prototype.map.call(e,function(e){var t="";return"deleted"===e.state?"":("completed"===e.state&&(t="checked"),'<li data-state="'.concat(e.state?e.state:"default",'" data-id="').concat(e._id,'" class="').concat(t?"checked":"",'">\n                        <label class="checkbox-container ').concat(t,'"> \n                            <input type="checkbox" ').concat(t?"checked":"",' class="').concat(t?"checked":"",'"><span class="todo-item-title">').concat(e.title,'</span><span class="checkmark"></span> \n                        </label><span class="close">×</span>\n                    </li>'))});this.get("#todolist").innerHTML=t.join(""),this.el=document.getElementById("todosection")}}}])&&i(n.prototype,r),a&&i(n,a),t}();n.default=a},{"../../lib/app":2}]},{},[3]);
//# sourceMappingURL=main.js.map
